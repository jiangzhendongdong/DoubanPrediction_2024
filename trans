import mysql.connector

class MovieDatabase:
    JDBC_DRIVER = "com.mysql.jdbc.Driver"
    DB_URL = "jdbc:mysql://localhost:3306/douban"
    USERNAME = "root"
    PASSWORD = "123456"

    def main(self, args):
        conn = None
        stmt = None
        rs = None

        try:
            # 加载 JDBC 驱动程序
            mysql.connector.register_driver(mysql.connector.Driver(self.JDBC_DRIVER))

            # 建立数据库连接
            conn = mysql.connector.connect(user=self.USERNAME, password=self.PASSWORD, host="localhost", database="movie_db")

            # 执行分页查询
            pageNumber = 1  # 当前页数
            pageSize = 10  # 每页数据条数
            offset = (pageNumber - 1) * pageSize  # 分页偏移量

            stmt = conn.cursor()
            sql = "SELECT * FROM movie_table LIMIT " + str(offset) + ", " + str(pageSize)
            stmt.execute(sql)

            # 处理查询结果
            while rs.fetchone():
                # 读取电影数据并进行相应的处理
                movieTitle = rs.get("title")
                # 其他字段...

                print("电影名称：" + movieTitle)

        except mysql.connector.Error as e:
            print(e)

        finally:
            if rs:
                rs.close()
            if stmt:
                stmt.close()
            if conn:
                conn.close()